<?xml version="1.0" encoding="UTF-8"?>
<bpmn2:definitions xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://www.omg.org/bpmn20"
                   xmlns:bpmn2="http://www.omg.org/spec/BPMN/20100524/MODEL"
                   xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI"
                   xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" xmlns:di="http://www.omg.org/spec/DD/20100524/DI"
                   xsi:schemaLocation="http://www.omg.org/spec/BPMN/20100524/MODEL BPMN20.xsd"
                   targetNamespace="http://www.omg.org/bpmn20">
    <bpmn2:process id="test" name="my test" isExecutable="true">
        <bpmn2:property id="transition"/>

        <bpmn2:startEvent id="start" name="start">
            <bpmn2:outgoing>saved</bpmn2:outgoing>
        </bpmn2:startEvent>
        <bpmn2:manualTask id="saved" name="saved">
            <bpmn2:incoming>save</bpmn2:incoming>
            <bpmn2:incoming>reject</bpmn2:incoming>
            <bpmn2:outgoing>save</bpmn2:outgoing>
            <bpmn2:outgoing>submit</bpmn2:outgoing>
        </bpmn2:manualTask>
        <bpmn2:manualTask id="published" name="published">
            <bpmn2:incoming>approve</bpmn2:incoming>
        </bpmn2:manualTask>
        <bpmn2:manualTask id="pending_approval" name="pending approval">
            <bpmn2:incoming>submit</bpmn2:incoming>
            <bpmn2:outgoing>approve</bpmn2:outgoing>
        </bpmn2:manualTask>
        <bpmn2:endEvent id="end" name="end">
            <bpmn2:incoming>killed</bpmn2:incoming>
        </bpmn2:endEvent>
        <bpmn2:sequenceFlow id="born" sourceRef="start" targetRef="saved"/>
        <bpmn2:sequenceFlow id="killed" sourceRef="published" targetRef="end"/>
        <bpmn2:sequenceFlow id="approve" name="approve" sourceRef="pending_approval" targetRef="published"/>
        <bpmn2:sequenceFlow id="submit" name="submit" sourceRef="saved" targetRef="pending_approval">
            <bpmn2:conditionExpression>
                return true
            </bpmn2:conditionExpression>
        </bpmn2:sequenceFlow>
        <bpmn2:sequenceFlow id="save" name="save" sourceRef="saved" targetRef="saved">
            <bpmn2:conditionExpression>
                return "save".equals(transition)
            </bpmn2:conditionExpression>
        </bpmn2:sequenceFlow>
    </bpmn2:process>
</bpmn2:definitions>
